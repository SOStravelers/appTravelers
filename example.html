<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carrusel Sincronizado Tarjeta/Fondo</title>
    <style>
        /* Reset básico y estilos generales */
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            margin: 0;
            background-color: #000;
            height: 100vh;
            overflow: hidden;
        }

        /* Contenedor principal */
        .sync-carousel-container {
            position: relative;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }

        /* Capa del video de fondo */
        .background-media {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            transition: opacity 0.3s ease-in-out;
        }

        .background-media video {
            display: block;
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* Carrusel de tarjetas */
        .info-card-carousel {
            position: absolute;
            bottom: 30px;
            left: 0;
            width: 100%;
            z-index: 2;
            overflow-x: scroll;
            overflow-y: hidden;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .info-card-carousel::-webkit-scrollbar {
            display: none;
        }

        /* Pista de tarjetas con espacio adicional */
        .info-card-track {
            display: flex;
            padding: 0 50px 0 25px; /* Más espacio a la derecha */
            gap: 15px;
        }
        .info-card-track::after {
            content: '';
            flex: 0 0 25px; /* Espacio final adicional */
        }

        /* Tarjetas individuales */
        .info-card-item {
            flex: 0 0 80%;
            max-width: 320px;
            scroll-snap-align: center;
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(5px);
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            display: flex;
            align-items: flex-start;
            gap: 12px;
            cursor: grab;
        }

        /* Estilos internos de tarjetas */
        .info-card-item img.thumbnail {
            width: 50px;
            height: 65px;
            object-fit: cover;
            border-radius: 8px;
            flex-shrink: 0;
        }

        .info-card-item .text-details {
            font-size: 0.9em;
            line-height: 1.4;
            color: #333;
            flex-grow: 1;
            min-width: 0;
        }

        .text-details .rating-duration {
            font-size: 0.85em;
            color: #555;
            margin-bottom: 4px;
            white-space: nowrap;
        }
        .text-details .rating-duration .star { color: #ff385c; }
        
        .text-details .title {
            font-size: 1.1em;
            font-weight: 600;
            color: #222;
            margin-bottom: 4px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .text-details .host {
            font-size: 0.85em;
            color: #555;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .info-card-item .like-button {
            background: none; border: none; padding: 0; cursor: pointer;
            font-size: 22px; color: #555; flex-shrink: 0;
            margin-left: auto;
            align-self: center;
        }

    </style>
</head>
<body>

    <div class="sync-carousel-container">
        <div class="background-media">
            <video id="background-video" autoplay muted loop playsinline></video>
        </div>

        <div class="info-card-carousel" id="info-carousel">
            <div class="info-card-track">
                <div class="info-card-item"
                     data-video-src="https://assets.mixkit.co/videos/preview/mixkit-fire-torch-burning-close-up-4538-large.mp4"
                     data-poster-src="https://picsum.photos/seed/fire_poster/800/600">
                    <img src="https://picsum.photos/seed/fire_thumb/100/130" alt="Thumbnail 1" class="thumbnail">
                    <div class="text-details">
                        <div class="rating-duration"><span class="star">★</span> 5.0 (187)<span> · </span>1.5 h</div>
                        <div class="title">Aprende a tragar fuego</div>
                        <div class="host">Anfitrión: Catherine</div>
                    </div>
                    <button class="like-button" aria-label="Añadir a favoritos">♡</button>
                </div>

                <div class="info-card-item"
                     data-video-src="https://assets.mixkit.co/videos/preview/mixkit-waves-coming-to-the-beach-5016-large.mp4"
                     data-poster-src="https://picsum.photos/seed/surf_poster/800/600">
                    <img src="https://picsum.photos/seed/surf_thumb/100/130" alt="Thumbnail 2" class="thumbnail">
                    <div class="text-details">
                        <div class="rating-duration"><span class="star">★</span> 4.9 (95)<span> · </span>2 h</div>
                        <div class="title">Clase de surf en la playa</div>
                        <div class="host">Anfitrión: Alex</div>
                    </div>
                    <button class="like-button" aria-label="Añadir a favoritos">♡</button>
                </div>

                <div class="info-card-item"
                     data-video-src="https://assets.mixkit.co/videos/preview/mixkit-stars-in-space-1610-large.mp4"
                     data-poster-src="https://picsum.photos/seed/stars_poster/800/600">
                    <img src="https://picsum.photos/seed/stars_thumb/100/130" alt="Thumbnail 3" class="thumbnail">
                    <div class="text-details">
                        <div class="rating-duration"><span class="star">★</span> 4.8 (250)<span> · </span>3 h</div>
                        <div class="title">Observación de estrellas</div>
                        <div class="host">Anfitrión: Dr. Orion</div>
                    </div>
                    <button class="like-button" aria-label="Añadir a favoritos">♡</button>
                </div>

                <div class="info-card-item"
                     data-video-src="https://assets.mixkit.co/videos/preview/mixkit-chef-cooking-in-a-restaurant-kitchen-40020-large.mp4"
                     data-poster-src="https://picsum.photos/seed/food_poster/800/600">
                    <img src="https://picsum.photos/seed/food_thumb/100/130" alt="Thumbnail 4" class="thumbnail">
                    <div class="text-details">
                        <div class="rating-duration"><span class="star">★</span> 4.9 (112)<span> · </span>2.5 h</div>
                        <div class="title">Clase de cocina gourmet</div>
                        <div class="host">Anfitrión: Chef Remy</div>
                    </div>
                    <button class="like-button" aria-label="Añadir a favoritos">♡</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const backgroundVideo = document.getElementById('background-video');
        const infoCarousel = document.getElementById('info-carousel');
        const infoCards = document.querySelectorAll('.info-card-item');
        const backgroundMediaContainer = document.querySelector('.background-media');

        let currentVideoSrc = '';

        function updateBackground(card) {
            const newVideoSrc = card.dataset.videoSrc;
            const newPosterSrc = card.dataset.posterSrc;

            if (newVideoSrc && newVideoSrc !== currentVideoSrc) {
                currentVideoSrc = newVideoSrc;
                backgroundMediaContainer.style.opacity = '0';

                setTimeout(() => {
                    backgroundVideo.poster = newPosterSrc || '';
                    backgroundVideo.src = newVideoSrc;
                    backgroundVideo.load();

                    backgroundVideo.onloadeddata = () => {
                        backgroundVideo.play().catch(error => console.error("Error al reproducir video:", error));
                        backgroundMediaContainer.style.opacity = '1';
                        backgroundVideo.onloadeddata = null;
                    };
                    backgroundVideo.onerror = (e) => {
                        console.error("Error al cargar el video:", e);
                        backgroundMediaContainer.style.opacity = '1';
                        backgroundVideo.onerror = null;
                    }

                }, 150);
            } else if (!newVideoSrc) {
                console.warn("La tarjeta no tiene data-video-src");
            }
        }

        const observerOptions = {
            root: infoCarousel,
            rootMargin: '0px',
            threshold: 0.75
        };

        const observerCallback = (entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && entry.intersectionRatio >= 0.75) {
                    updateBackground(entry.target);
                }
            });
        };

        const observer = new IntersectionObserver(observerCallback, observerOptions);
        infoCards.forEach(card => observer.observe(card));

        if (infoCards.length > 0) {
            const firstCard = infoCards[0];
            currentVideoSrc = firstCard.dataset.videoSrc;
            backgroundVideo.poster = firstCard.dataset.posterSrc || '';
            backgroundVideo.src = currentVideoSrc;
            backgroundVideo.load();
            backgroundVideo.play().catch(error => console.error("Error inicial al reproducir video:", error));
            backgroundMediaContainer.style.opacity = '1';
        }

        document.querySelectorAll('.like-button').forEach(button => {
            button.addEventListener('click', (e) => {
                e.stopPropagation();
                if (button.innerHTML.includes('♡')) {
                    button.innerHTML = '❤️';
                    button.style.color = '#ff385c';
                } else {
                    button.innerHTML = '♡';
                    button.style.color = '#555';
                }
            });
        });

    </script>

</body>
</html>